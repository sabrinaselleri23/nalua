<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NALUA â€” Apoio e ConscientizaÃ§Ã£o em SaÃºde Mental</title>

  <!-- Ãcone do site -->
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    /* Estilo bÃ¡sico do modal e chat de desabafo */
    .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index: 9999; }
    .modal.show { display: flex; }
    .modal-content { background: #fff; padding: 20px; max-width: 400px; width: 90%; border-radius: 8px; position: relative; }
    .panel { max-height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; margin-bottom: 10px; }
    #chatInput { width: 100%; padding: 8px; margin-top: 5px; }
    .close-btn { position: absolute; top: 10px; right: 10px; cursor: pointer; }
  </style>
</head>

<body>
<header>
  <div class="header-left">
    <img id="site-logo" src="favicon.png" alt="Logo Na Lua">
    <p class="subtitle">Apoio e ConscientizaÃ§Ã£o em SaÃºde Mental</p>
  </div>

  <nav>
    <!-- seu menu -->
  </nav>
</header>

<main class="container">
  <!-- HERO -->
  <section id="inicio" class="hero card">
    <div class="left">
      <h2>Bem-vindo Ã  NALUA</h2>
    </div>
  </section>

  <div class="grid">
    <div>
      <!-- NOTÃCIAS -->
      <section id="noticias" class="card">
        <h3>NotÃ­cias & AtualizaÃ§Ãµes</h3>
        <p class="hint">Ãšltimas informaÃ§Ãµes â€” atualizadas automaticamente.</p>
        <div id="newsList"></div>
        <button id="loadNews" class="chat-btn secondary">ðŸ”„ Atualizar agora</button>
      </section>

      <!-- AJUDA RÃPIDA -->
      <section id="ajuda" class="card">
        <h3>Recursos de Ajuda RÃ¡pida</h3>
        <ul>
          <li>Contato via WhatsApp.</li>
          <li>Links Ãºteis: CVV, CAPS, CRAS.</li>
          <li>Comunidades online seguras.</li>
        </ul>
        <div class="buttons">
          <a class="chat-btn" id="whatsappQuick" href="#" target="_blank">ðŸ’¬ WhatsApp</a>
        </div>
      </section>
    </div>

    <aside>
      <!-- MAPA -->
      <section id="mapa" class="card">
        <h3>Mapa de Apoio</h3>
        <div id="map" style="height: 500px;"></div>
      </section>

      <!-- CHATBOT -->
      <section id="chatbot" class="card">
        <h3>Chatbot</h3>
        <p>Mensagem de acolhimento e botÃ£o de atendimento.</p>
        <button class="chat-btn" id="openChatBtn2">Abrir Chat</button>
        <button class="chat-btn" id="openBotBtn">ðŸ’¬ Desabafo</button>
      </section>
    </aside>
  </div>

  <footer>
    <small>Desenvolvido para fins acadÃªmicos â€” NA LUA Â© 2025</small>
  </footer>
</main>

<!-- MODAL CHATBOT -->
<div class="modal" id="chatModal">
  <div class="panel">
    <div class="chat-header">
      <h3>Acolhimento â€” NA LUA</h3>
      <button class="close-btn" id="closeModal">&times;</button>
    </div>
    <div class="chat-body" id="chatBody"></div>
    <textarea id="chatInput" placeholder="Digite sua mensagem..."></textarea>
    <button id="sendBtn">Enviar</button>
  </div>
</div>


<!-- SCRIPTS -->
<script src="script.js"></script>
<script>
  // ==============================
  // BOTÃƒO CHAT DE DESABAFO (Nova Janela)
  // ==============================
  const openBotBtn = document.getElementById('openBotBtn');
  openBotBtn.addEventListener('click', () => {
    const chatWindow = window.open('', 'Desabafo', 'width=400,height=600,resizable=yes');
    chatWindow.document.write(`
      <html>
      <head>
        <title>Chat de Desabafo â€” NA LUA</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 10px; }
          .panel { height: 500px; border: 1px solid #ccc; overflow-y: auto; padding: 5px; margin-bottom: 10px; }
          textarea { width: 100%; padding: 8px; }
          button { padding: 8px 12px; margin-top: 5px; }
        </style>
      </head>
      <body>
        <h3>Chat de Desabafo</h3>
        <div class="panel" id="chatPanel"></div>
        <textarea id="chatInput" placeholder="Escreva seus sentimentos..."></textarea>
        <button id="sendBtn">Enviar</button>

        <script>
          const chatPanel = document.getElementById('chatPanel');
          const chatInput = document.getElementById('chatInput');
          const sendBtn = document.getElementById('sendBtn');

          sendBtn.addEventListener('click', () => {
            const msg = chatInput.value.trim();
            if(!msg) return;
            chatInput.value = "";

            // Palavras que indicam risco â€” encaminhar para WhatsApp
            const palavrasRisco = ["eu nÃ£o aguento", "suicÃ­dio", "nÃ£o quero mais", "acabou"];
            const msgLower = msg.toLowerCase();
            const temRisco = palavrasRisco.some(p => msgLower.includes(p));

            if(temRisco) {
              chatPanel.innerHTML += "<p><b>Alerta:</b> Vamos te conectar com um atendimento via WhatsApp.</p>";
              window.open('https://api.whatsapp.com/send?phone=SEU_NUMERO&text=' + encodeURIComponent('Preciso de ajuda agora'), '_blank');
            } else {
              chatPanel.innerHTML += "<p><b>IA:</b> " + "Obrigado por compartilhar. Lembre-se de respirar fundo e que vocÃª nÃ£o estÃ¡ sozinho." + "</p>";
            }
            chatPanel.scrollTop = chatPanel.scrollHeight;
          });
        </script>
      </body>
      </html>
    `);
  });
</script>
</body>
</html>
